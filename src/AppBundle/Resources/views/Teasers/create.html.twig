{% extends 'AppBundle:Admin:index.html.twig' %}

 {% block mainAdminContent %}
     <div class="page-title" xmlns="http://www.w3.org/1999/html">
         <h3>{{ "Add news place" | trans }}</h3>
     </div>

     <div class="row">
         <div class="col-md-12">
             <div class="grid simple">
                 {#<div class="grid-title no-border">#}
                 {#<h4>{{ "Добавить рубрику" | trans }}</h4>#}
                 {#</div>#}

                 <div class="grid-body no-border"> <br>
                     <div class="row">

                         <div class="progress">
                             <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
                         </div>

                         {{ form_start(form) }}
                         {{ form_errors(form) }}

                         <div>
                             {#{{ form_widget(form.save) }}#}
                         </div>

                         {{ form_end(form) }}

                     </div>
                 </div>
             </div>
         </div>
     </div>
 {% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('/bundles/app/js/fileupload/jquery.ui.widget.js') }}"></script>
    <script src="{{ asset('/bundles/app/js/fileupload/jquery.iframe-transport.js') }}"></script>
    <script src="{{ asset('/bundles/app/js/fileupload/jquery.fileupload.js') }}"></script>
    <script type="text/javascript">
        $(document).ready(function() {

            $('#appbundle_teasers_title').parent()
                    .before('<input type="file" name="pictures[]" multiple class="btn btn-success btn-cons uploadImages"/><div id="img_previews" class="col-lg-12"></div><div class="clearfix"></div> ');
//            $('#appbundle_teasers_image').remove();

            $('.uploadImages').fileupload({
                dataType: 'json',
                autoUpload: true,
                url: '{{ path('upload_files') }}',
                progress: function (e, data) {
                    var all = $('.uploadImages').fileupload('progress');
                    var progress = all.loaded / all.total * 100;
                    //console.log(Math.round(progress));
                    $('.progress-bar').animate({
                        'width' : progress + "%"
                    }, 50);
                },
                done: function (e, data) {
                    $('#img_previews').append(data.result.thumb);
                }
            });

            $(document).on('click', '.removePreview', function() {
                if ( confirm('Remove image?') ) {
                    $(this).parent().remove();
                }
            });

        });
    </script>
{% endblock %}
